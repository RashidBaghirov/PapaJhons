@inject Papa_Jhons.Services.LayoutService layoutService
@{
    User user = await layoutService.GetUserFullName();
    List<Category> categories = layoutService.AllCategory();
    BasketVm basket = layoutService.GetBaskets();
    List<Product> products = layoutService.GetProducts(); 

}

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;500;600;700;800&display=swap"
          rel="stylesheet">
    <link rel="icon" type="image/png" sizes="194x194"
          href="https://www.papajohns.az/img/content/favicon/favicon-194x194.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css" />
    <link rel="stylesheet" href="~/assets/css/main.css">

    <title>Papa John's</title>
</head>

<body>

    <header>
        <div class="container-fluid">
            <div class="row header-top">
                <div class="col-6">
                    <a asp-controller="home" asp-action="index">
                        <img class="logo" src="~/assets/images/pj_logo_web_new.png" alt="">
                    </a>
                </div>
                <div class="col-6">
                    <div class="header-right">
                        <div class="basket">
                            <a href="" data-bs-toggle="modal" data-bs-target="#basketModal">
                                <i class="fas fa-shopping-basket">
                                    <span class="basket-count">@basket.BasketItems.Count</span>
                                </i>
                                <div class="basket-price">
                                    <span>@basket.TotalPrice</span>
                                    <span>₼</span>
                                </div>
                            </a>
                        </div>
                   
                        <div class="sign d-none d-md-block ">
                            @if (User.Identity.IsAuthenticated)
                            {
                                    <div class="select-menu">
                                <div class="select-btn">
                                    <i class="fa fa-user"></i>
                                        <span class="sBtn-text">@user.FullName</span>
                                    <i class="fa fa-caret-down"></i>
                                </div>

                                <ul class="options">
                                    <li class="option">
                                        <i class="fa fa-home" aria-hidden="true"></i>
                                        <a asp-controller="account" asp-action="index" class="option-text">Profiliniz</a>
                                    </li>
                                    <li class="option">
                                        <i class="fa fa-sign-out" aria-hidden="true"></i>
                                            <a asp-controller="account" asp-action="logout" class="option-text">Çıxış</a>
                                    </li>

                                </ul>
                                </div>
                            }
                            else
                            {
                                <a href="" data-bs-toggle="modal" data-bs-target="#loginModal">Sign In</a>
                                <a href="" data-bs-toggle="modal" data-bs-target="#registerModal">/ Sign Up</a>
                            }
                  
                        </div>
                        <div class="mobile-menu d-block d-md-none  ">
                            <div class="hamburger-menu" data-bs-toggle="offcanvas" data-bs-target="#offcanvasRight"
                                 aria-controls="offcanvasRight">
                                <i class="fa fa-bars"></i>
                            </div>


                            <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasRight"
                                 aria-labelledby="offcanvasRightLabel">
                                <div class="offcanvas-header">
                                    <button type="button" class="btn-close" data-bs-dismiss="offcanvas"
                                            aria-label="Close"></button>
                                </div>
                                <div class="offcanvas-body">

                                    <div class="sign mobile-menu-account">
                                              @if (User.Identity.IsAuthenticated)
                                        {
                                            <a asp-controller="account" asp-action="index" class="option-text">@user.FullName</a>
                                            <a asp-controller="account" asp-action="logout" class="option-text">Çıxış</a>
                                        }
                                        else
                                        {
                                            <a data-bs-toggle="modal" data-bs-target="#loginModal">Sign In</a>
                                            <a data-bs-toggle="modal" data-bs-target="#registerModal">/ Sign Up</a>
                                        }

                                     
                                    </div>

                                    <div class="sign  ">
                                        <div class="select-menu mobile-menu-tab-items">
                                            <div class="select-btn">
                                                <span class="sBtn-text">MENU</span>
                                                <i class="fa fa-caret-down"></i>
                                            </div>

                                            <ul class="options mobile-menu-tab-body">
                                                <li><a asp-controller="offer" asp-action="index">Offers</a></li>
                                                @foreach (var item in categories)
                                                {
                                                    <li><a asp-controller="Product" asp-action="pizzaview" asp-route-id="@item.Id">@item.Name</a></li>
                                                }
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
            <div class="row header-bottom d-none d-md-block">
                <ul>
                    <li><a asp-controller="offer" asp-action="index">Offers</a></li>
                    @foreach (var item in categories)
                    {
                        <li><a asp-controller="Product" asp-action="pizzaview" asp-route-id="@item.Id">@item.Name</a></li>
                    }
                </ul>
            </div>
            </div>
    </header>

    <section class="top-bar d-md-none"></section>
        <main role="main" class="pb-3">
            @RenderBody()
        </main>
    <footer>
        <div class="container-fluid">
            <div class="row">
                <div class="col-lg-7 col-12">
                    <ul class="footer-list">
                        <li><a asp-controller="home" asp-action="aboutUs">About Us</a></li>
                        <li><a asp-controller="home" asp-action="contactUs">Contact Us</a></li>
                        <li><a asp-controller="home" asp-action="faq">FAQ</a></li>
                        <li><a asp-controller="home" asp-action="Rules">Terms and Conditions</a></li>
                    </ul>
                </div>
                <div class="col-lg-3 col-6 footer-img">
                    <img src="~/assets/images/footer.png" alt="">
                </div>
                <div class="col-lg-2 col-6">
                    <ul class="social">
                        <li>
                            <a href="https://www.facebook.com/papajohns.az/">
                                <i class="fa fa-facebook" aria-hidden="true"></i>
                            </a>
                        </li>
                        <li>
                            <a href="https://twitter.com/azpapajohns">
                                <i class="fa fa-twitter" aria-hidden="true"></i>
                            </a>
                        </li>
                        <li>
                            <a href="https://www.instagram.com/azpapajohns/">
                                <i class="fa fa-instagram" aria-hidden="true"></i>
                            </a>
                        </li>


                    </ul>
                </div>
            </div>
        </div>
    </footer>


    <!-- Modal for Login start -->
    <div class="modal fade  account-modal" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel"
         aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="loginModalLabel">Log In</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    @await Html.PartialAsync("_LoginPartial", new LoginVm())
                </div>
                <div class="modal-footer">
                    <p>Not a member?</p>
                    <a data-bs-toggle="modal" data-bs-target="#registerModal">SIGN UP</a>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal for Login finish -->
    <!-- Modal for Register start -->
    <div class="modal fade account-modal" id="registerModal" tabindex="-1" aria-labelledby="registerModallLabel"
         aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title create-account" id="registerModalLabel">Create An Account</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    @await Html.PartialAsync("_RegisterPartial", new RegisterVM())
                </div>
                <div class="modal-footer">
                    <p>Already a member?</p>
                    <a data-bs-toggle="modal" data-bs-target="#loginModal">SIGN IN</a>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal for Register finish -->
    <!-- Modal for Forgot Password start -->
    <div class="modal fade account-modal" id="forgotModal" tabindex="-1" aria-labelledby="forgotModalLabel"
         aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title forgot-title" id="forgotModalLabel">Forgot Password</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                 @await Html.PartialAsync("_ForgotPartial",new AccountVM())
                </div>
                <div class="modal-footer">
                    <p>Back to</p>
                    <a data-bs-toggle="modal" data-bs-target="#loginModal" class="show-login-modal">SIGN IN</a>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal for Forgot Password finish -->
    <!-- Modal for Basket start -->
    <div class="modal fade basket-modal " id="basketModal" tabindex="-1" aria-labelledby="basketModalLabel"
         aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content ">
                <div class="modal-header">
                    <h5 class="modal-title" id="basketModalLabel">Your Basket</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="container">
                        <div class="modal-basket-count">
                            Items in your basket: <strong>@basket.BasketItems.Count</strong>
                        </div>
                        @foreach (var item in basket.BasketItems)
                        {
                            Product product = products.FirstOrDefault(x=>x.Id==item.Product.Id);
                            <div class="row basket-items">
                                <div class="col-12 col-sm-7 basket-left">
                                    <div class="basket-img">
                                        <img src="@product.ImagePath"
                                             alt="">
                                    </div>
                                    <div class="basket-prd-name">
                                        <p>@product.Name</p>
                                    </div>
                                </div>
                                <div class="col-8 col-sm-5 basket-right">
                                    <div class="basket-prd-count">
                                        <div class="basket-prd-count">
                                            <div class="minus count-box">
                                                <i class="fa fa-minus" aria-hidden="true"></i>
                                            </div>
                                            <span class="count-value count-box">@item.Count</span>
                                            <div class="plus count-box">
                                                <i class="fa fa-plus" aria-hidden="true"></i>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="prd-total-amount">
                                        <span class="prd-price">@(item.Count * @item.Product.Price)</span>
                                        <span>₼</span>
                                        <i class="fa fa-times remove-prd" aria-hidden="true" onclick="removeBasketItem('@product.Id')"></i>
                                    </div>
                              

                                </div>
                            </div>
                        }
                      

                    </div>
                </div>
                <div class="modal-footer">
                    <div class="container">
                        <div class="row mt-4 mt-sm-0 position-relative">
                            <div class="col-12 col-sm-6 go-checkout">
                                <a class="" asp-controller="Order" asp-action="Checkout">CHECKOUT</a>
                            </div>
                            <div class="col-12 col-sm-6 go-shop">
                                <a asp-controller="Product" asp-action="index" asp-route-id="2">BACK TO SHOP</a>
                            </div>
                            <div class="col-12 col-sm-6">
                                <div class="total-amount">
                                    <p>Total Amount:</p>
                                    <span class="total-price">@basket.TotalPrice</span>
                                    <span>₼</span>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
    <!-- Modal for Basket finish -->



    <script src="https://code.jquery.com/jquery-3.6.1.js"
            integrity="sha256-3zlB5s2uwoUzrXK3BT7AX3FyvojsraNFxCc2vC/7pNI=" crossorigin="anonymous"></script>
    <script src="https://kit.fontawesome.com/b26885e958.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz" crossorigin="anonymous"></script>

    <script src="~/assets/js/index.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
    @RenderSection("Script",false)

</body>

</html>
